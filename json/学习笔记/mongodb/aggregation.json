{"data":{"_id":"BJYJj8hTQ","title":"aggregation聚合的使用","date":"2018-11-16 22:59","update":"2018-11-16 22:59","series":"mongodb&mongoose学习笔记","categories":["学习笔记"],"tags":["数据库","mongodb"]},"__content":"<h2 id=\"%E6%88%91%E7%9A%84%E7%90%86%E8%A7%A3\" tabindex=\"-1\">我的理解</h2>\n<p>aggregation聚合操作,就像<code>linux</code>中的管道操作<code>|</code>一样,通过不停的修改操作文档序列,最后达到想要的数据.</p>\n<p>文档地址: <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/\">https://docs.mongodb.com/manual/reference/operator/aggregation/</a></p>\n<h2 id=\"%E5%B8%B8%E7%94%A8%E7%9A%84%E6%93%8D%E4%BD%9C%E6%9C%89%E5%93%AA%E4%BA%9B\" tabindex=\"-1\">常用的操作有哪些</h2>\n<p>分为两个主要的部分<code>Aggregation Pipeline Stages</code>(阶段),<code>Aggregation Pipeline Operators</code>(具体操作)</p>\n<p>stage操作中的<code>$count</code>可以为一下个阶段的操作文档添加一个新的属性名,这个属性名的值就是接收的文档的数量.</p>\n<pre><code>{ $count: &lt;string&gt; }\n</code></pre>\n<p>操作<code>$addToSet</code>,这个操作只能和stage<code>$group</code>一起用,作用是把数据加入一个集合中</p>\n<p>例子:<a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/addToSet/\">https://docs.mongodb.com/manual/reference/operator/aggregation/addToSet/</a></p>\n"}