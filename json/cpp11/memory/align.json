{"data":{},"__content":"<p><a href=\"https://en.cppreference.com/w/cpp/memory/align\">std::align - cppreference.com</a></p>\n<p>要看当目录下的code下的 三个cpp文件,就理解了</p>\n<p><a href=\"https://stackoverflow.com/a/67834958/5757674\">https://stackoverflow.com/a/67834958/5757674</a></p>\n<pre><code class=\"language-cpp\">inline void*\nalign(size_t __align, size_t __size, void*&amp; __ptr, size_t&amp; __space) noexcept\n{\n  if (__space &lt; __size) //剩余的空间不夠\n    return nullptr;\n  const auto __intptr = reinterpret_cast&lt;uintptr_t&gt;(__ptr);\n\n  //核心计算 (x-1 + y) &amp; -y ,得到align倍数\n  const auto __aligned = (__intptr - 1u + __align) &amp; -__align;\n  const auto __diff = __aligned - __intptr;\n  if (__diff &gt; (__space - __size))\n    return nullptr;\n  else\n    {\n      __space -= __diff;\n      return __ptr = reinterpret_cast&lt;void*&gt;(__aligned);\n      // 返回的值是 对齐后的起点\n      // space 对齐后剩下的空间\n    }\n}\n</code></pre>\n"}