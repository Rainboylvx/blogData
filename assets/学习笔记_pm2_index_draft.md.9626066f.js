import{_ as s,j as a,g as n,I as o}from"./chunks/framework.6fa7194a.js";const q=JSON.parse('{"title":"\u7B80\u4ECB","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u7B80\u4ECB","slug":"\u7B80\u4ECB"},{"level":2,"title":"\u5168\u5C40\u5B89\u88C5","slug":"\u5168\u5C40\u5B89\u88C5"},{"level":2,"title":"\u7528\u6CD5","slug":"\u7528\u6CD5"},{"level":2,"title":"\u53C2\u6570\u8BF4\u660E","slug":"\u53C2\u6570\u8BF4\u660E"},{"level":2,"title":"\u914D\u7F6E\u6587\u4EF6","slug":"\u914D\u7F6E\u6587\u4EF6"},{"level":3,"title":"\u5B8C\u6574\u53C2\u6570\u5355\u4E2Aapp\u914D\u7F6E\uFF1A","slug":"\u5B8C\u6574\u53C2\u6570\u5355\u4E2Aapp\u914D\u7F6E\uFF1A"}],"relativePath":"\u5B66\u4E60\u7B14\u8BB0/pm2/index_draft.md"}'),p={name:"\u5B66\u4E60\u7B14\u8BB0/pm2/index_draft.md"},l=o(`<h2 id="\u7B80\u4ECB" tabindex="-1">\u7B80\u4ECB <a class="header-anchor" href="#\u7B80\u4ECB" aria-hidden="true">#</a></h2><blockquote><p><code>pm2\u662Fnode\u8FDB\u7A0B\u7BA1\u7406\u5DE5\u5177\uFF0C\u53EF\u4EE5\u5229\u7528\u5B83\u6765\u7B80\u5316\u5F88\u591Anode\u5E94\u7528\u7BA1\u7406\u7684\u7E41\u7410\u4EFB\u52A1\uFF0C\u5982\u6027\u80FD\u76D1\u63A7\u3001\u81EA\u52A8\u91CD\u542F\u3001\u8D1F\u8F7D\u5747\u8861\u7B49\uFF0C\u800C\u4E14\u4F7F\u7528\u975E\u5E38\u7B80\u5355\u3002</code></p></blockquote><h2 id="\u5168\u5C40\u5B89\u88C5" tabindex="-1">\u5168\u5C40\u5B89\u88C5 <a class="header-anchor" href="#\u5168\u5C40\u5B89\u88C5" aria-hidden="true">#</a></h2><p>sudo npm install <code>pm2@latest -g</code></p><h2 id="\u7528\u6CD5" tabindex="-1">\u7528\u6CD5 <a class="header-anchor" href="#\u7528\u6CD5" aria-hidden="true">#</a></h2><ul><li>\u6700\u7B80\u5355\u7684\u542F\u7528\u4E00\u4E2A\u5E94\u7528: <code>pm2 start app.js</code></li><li>\u505C\u6B62\uFF1A<code>pm2 stop app_name|app_id</code></li><li>\u5220\u9664\uFF1A<code>pm2 delete app_name|app_id</code></li><li>\u91CD\u542F\uFF1A<code>pm2 restart app_name|app_id</code></li><li>\u505C\u6B62\u6240\u6709\uFF1A<code>pm2 stop all</code></li><li>\u67E5\u770B\u6240\u6709\u7684\u8FDB\u7A0B\uFF1A<code>pm2 list</code></li><li>\u67E5\u770B\u6240\u6709\u7684\u8FDB\u7A0B\u72B6\u6001\uFF1A<code>pm2 status</code></li><li>\u67E5\u770B\u67D0\u4E00\u4E2A\u8FDB\u7A0B\u7684\u4FE1\u606F\uFF1A<code>pm2 describe app_name|app_id</code></li><li>\u76D1\u542C:<code>pm2 monit</code></li></ul><h2 id="\u53C2\u6570\u8BF4\u660E" tabindex="-1">\u53C2\u6570\u8BF4\u660E <a class="header-anchor" href="#\u53C2\u6570\u8BF4\u660E" aria-hidden="true">#</a></h2><ul><li>--watch\uFF1A\u76D1\u542C\u5E94\u7528\u76EE\u5F55\u6E90\u7801\u7684\u53D8\u5316\uFF0C\u4E00\u65E6\u53D1\u751F\u53D8\u5316\uFF0C\u81EA\u52A8\u91CD\u542F\u3002\u5982\u679C\u8981\u7CBE\u786E\u76D1\u542C\u3001\u4E0D\u89C1\u542C\u7684\u76EE\u5F55\uFF0C\u6700\u597D\u901A\u8FC7\u914D\u7F6E\u6587\u4EF6</li><li>-i --instances\uFF1A\u542F\u7528\u591A\u5C11\u4E2A\u5B9E\u4F8B\uFF0C\u53EF\u7528\u4E8E\u8D1F\u8F7D\u5747\u8861\u3002\u5982\u679C-i 0\u6216\u8005-i max\uFF0C\u5219\u6839\u636E\u5F53\u524D\u673A\u5668\u6838\u6570\u786E\u5B9A\u5B9E\u4F8B\u6570\u76EE\uFF0C\u53EF\u4EE5\u5F25\u8865node.js\u7F3A\u9677</li><li>--ignore-watch\uFF1A\u6392\u9664\u76D1\u542C\u7684\u76EE\u5F55/\u6587\u4EF6\uFF0C\u53EF\u4EE5\u662F\u7279\u5B9A\u7684\u6587\u4EF6\u540D\uFF0C\u4E5F\u53EF\u4EE5\u662F\u6B63\u5219\u3002\u6BD4\u5982--ignore-watch=&quot;test node_modules &quot;some scripts&quot;</li><li>-n --name\uFF1A\u5E94\u7528\u7684\u540D\u79F0\u3002\u67E5\u770B\u5E94\u7528\u4FE1\u606F\u7684\u65F6\u5019\u53EF\u4EE5\u7528\u5230</li><li>-o --output <code>&lt;path&gt;</code>\uFF1A\u6807\u51C6\u8F93\u51FA\u65E5\u5FD7\u6587\u4EF6\u7684\u8DEF\u5F84\uFF0C\u6709\u9ED8\u8BA4\u8DEF\u5F84</li><li>-e --error <code>&lt;path&gt;</code>\uFF1A\u9519\u8BEF\u8F93\u51FA\u65E5\u5FD7\u6587\u4EF6\u7684\u8DEF\u5F84\uFF0C\u6709\u9ED8\u8BA4\u8DEF\u5F84</li><li>--interpreter <code>&lt;interpreter&gt;</code>\uFF1Athe interpreter pm2 should use for executing app (bash, python...)\u3002\u6BD4\u5982\u4F60\u7528\u7684coffee script\u6765\u7F16\u5199\u5E94\u7528</li></ul><h2 id="\u914D\u7F6E\u6587\u4EF6" tabindex="-1">\u914D\u7F6E\u6587\u4EF6 <a class="header-anchor" href="#\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a></h2><p>\u914D\u7F6E\u6587\u4EF6\u91CC\u7684\u8BBE\u7F6E\u9879\uFF0C\u8DDF\u547D\u4EE4\u884C\u53C2\u6570\u57FA\u672C\u662F\u4E00\u4E00\u5BF9\u5E94\u7684 \u914D\u7F6E\u6587\u4EF6\u7684\u683C\u5F0F\u53EF\u4EE5\u4E3Ajson/yaml json\u683C\u5F0F\u7684\u914D\u7F6E\u6587\u4EF6\uFF0Cpm2\u5F53\u4F5C\u666E\u901A\u7684js\u6587\u4EF6\u6765\u5904\u7406\uFF0C\u6240\u4EE5\u53EF\u4EE5\u5728\u91CC\u9762\u6DFB\u52A0\u6CE8\u91CA\u6216\u8005\u7F16\u5199\u4EE3\u7801\uFF0C\u8FD9\u5BF9\u4E8E\u52A8\u6001\u8C03\u6574\u914D\u7F6E\u5F88\u6709\u597D\u5904 \u5982\u679C\u542F\u52A8\u7684\u65F6\u5019\u6307\u5B9A\u4E86\u914D\u7F6E\u6587\u4EF6\uFF0C\u90A3\u4E48\u547D\u4EE4\u884C\u53C2\u6570\u4F1A\u88AB\u5FFD\u7565\uFF08\u4E2A\u522B\u53C2\u6570\u9664\u5916\uFF0C\u6BD4\u5982--env\uFF09</p><h3 id="\u5B8C\u6574\u53C2\u6570\u5355\u4E2Aapp\u914D\u7F6E\uFF1A" tabindex="-1">\u5B8C\u6574\u53C2\u6570\u5355\u4E2Aapp\u914D\u7F6E\uFF1A <a class="header-anchor" href="#\u5B8C\u6574\u53C2\u6570\u5355\u4E2Aapp\u914D\u7F6E\uFF1A" aria-hidden="true">#</a></h3><div class="language-javascript line-numbers-mode"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">             : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">node-app</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">//\u542F\u52A8app\u540D\u79F0</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cwd</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">              : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/srv/node-app/current</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">args</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">             : [</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">--toto=heya coco</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-d</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">script</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">           : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">bin/app.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">node_args</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">        : [</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">--harmony</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> --max-stack-size=102400000</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">log_date_format</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">  : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">YYYY-MM-DD HH:mm Z</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">error_file</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">       : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/var/log/node-app/node-app.stderr.log</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">out_file</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">         : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">log/node-app.stdout.log</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pid_file</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">         : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pids/node-geo-api.pid</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">instances</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">        : </span><span style="color:#F78C6C;">6</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">//or 0 =&gt; &#39;max&#39;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">min_uptime</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">       : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">200s</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// 200 seconds, defaults to 1000</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">max_restarts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">     : </span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// defaults to 15</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">max_memory_restart</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1M</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// 1 megabytes, e.g.: &quot;2G&quot;, &quot;10M&quot;, &quot;100K&quot;, 1024 the default unit is byte.</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cron_restart</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">     : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1 0 * * *</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">watch</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">            : </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ignore_watch</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">      : [</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">[</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">/</span><span style="color:#A6ACCD;">\\\\\\\\</span><span style="color:#C3E88D;">]</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">./</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">node_modules</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">merge_logs</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">       : </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">exec_interpreter</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;"> : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">node</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">exec_mode</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">        : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fork</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">autorestart</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">      : </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// enable/disable automatic restart when an app crashes or exits</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">vizion</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">           : </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// enable/disable vizion features (versioning control)</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// Default environment variables that will be injected in any environment and at any start</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">env</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">NODE_ENV</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">production</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">AWESOME_SERVICE_API_TOKEN</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">xxx</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">env_*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;"> : </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">SPECIFIC_ENV</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>\u5B8C\u6574\u914D\u7F6E\u6587\u4EF6\u5199\u6CD5\uFF1A { &quot;apps&quot; : [{ // Application #1 &quot;name&quot; : &quot;worker-app&quot;, &quot;script&quot; : &quot;worker.js&quot;, &quot;args&quot; : [&quot;--toto=heya coco&quot;, &quot;-d&quot;, &quot;1&quot;], &quot;watch&quot; : true, &quot;node_args&quot; : &quot;--harmony&quot;, &quot;merge_logs&quot; : true, &quot;cwd&quot; : &quot;/this/is/a/path/to/start/script&quot;, &quot;env&quot;: { &quot;NODE_ENV&quot;: &quot;development&quot;, &quot;AWESOME_SERVICE_API_TOKEN&quot;: &quot;xxx&quot; }, &quot;env_production&quot; : { &quot;NODE_ENV&quot;: &quot;production&quot; }, &quot;env_staging&quot; : { &quot;NODE_ENV&quot; : &quot;staging&quot;, &quot;TEST&quot; : true } },{ // Application #2 &quot;name&quot; : &quot;api-app&quot;, &quot;script&quot; : &quot;api.js&quot;, &quot;instances&quot; : 4, &quot;exec_mode&quot; : &quot;cluster_mode&quot;, &quot;error_file&quot; : &quot;./examples/child-err.log&quot;, &quot;out_file&quot; : &quot;./examples/child-out.log&quot;, &quot;pid_file&quot; : &quot;./examples/child.pid&quot; }] }</p><p>\u901A\u8FC7yaml\u7BA1\u7406\u591A\u4E2A\u5E94\u7528 process.yml:</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">apps:</span></span>
<span class="line"><span style="color:#A6ACCD;">  - script   : app.js</span></span>
<span class="line"><span style="color:#A6ACCD;">    instances: 4</span></span>
<span class="line"><span style="color:#A6ACCD;">    exec_mode: cluster</span></span>
<span class="line"><span style="color:#A6ACCD;">  - script : worker.js</span></span>
<span class="line"><span style="color:#A6ACCD;">    watch  : true</span></span>
<span class="line"><span style="color:#A6ACCD;">    env    :</span></span>
<span class="line"><span style="color:#A6ACCD;">      NODE_ENV: development</span></span>
<span class="line"><span style="color:#A6ACCD;">    env_production:</span></span>
<span class="line"><span style="color:#A6ACCD;">      NODE_ENV: production</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>\u542F\u52A8\uFF1Apm2 start process.yml \u73AF\u5883\u5207\u6362 \u6B63\u5F0F\u5F00\u53D1\u4E2D\u5206\u4E3A\u4E0D\u540C\u7684\u73AF\u5883(\u5F00\u53D1\u73AF\u5883\u3001\u6D4B\u8BD5\u73AF\u5883\u3001\u751F\u4EA7\u73AF\u5883)\uFF0C\u6211\u4EEC\u9700\u8981\u6839\u636E\u4E0D\u540C\u7684\u60C5\u666F\u6765\u5207\u6362\u5404\u79CD\u73AF\u5883 pm2\u901A\u8FC7\u5728\u914D\u7F6E\u6587\u4EF6\u4E2D\u901A\u8FC7env_xx\u6765\u58F0\u660E\u4E0D\u540C\u73AF\u5883\u7684\u914D\u7F6E\uFF0C\u7136\u540E\u5728\u542F\u52A8\u5E94\u7528\u65F6\uFF0C\u901A\u8FC7--env\u53C2\u6570\u6307\u5B9A\u8FD0\u884C\u7684\u73AF\u5883 \u73AF\u5883\u914D\u7F6E\u5B9A\u4E49\uFF0C\u5728\u5E94\u7528\u4E2D\uFF0C\u53EF\u4EE5\u901A\u8FC7p<wbr>rocess.env.REMOTE_ADDR\u7B49\u6765\u8BFB\u53D6\u914D\u7F6E\u4E2D\u751F\u547D\u7684\u53D8\u91CF\uFF1A &quot;env&quot;: { &quot;NODE_ENV&quot;: &quot;production&quot;, &quot;REMOTE_ADDR&quot;: &quot;<a href="http://www.example.com/" target="_blank" rel="noreferrer">http://www.example.com/</a>&quot; }, &quot;env_dev&quot;: { &quot;NODE_ENV&quot;: &quot;development&quot;, &quot;REMOTE_ADDR&quot;: &quot;<a href="http://wdev.example.com/" target="_blank" rel="noreferrer">http://wdev.example.com/</a>&quot; }, &quot;env_test&quot;: { &quot;NODE_ENV&quot;: &quot;test&quot;, &quot;REMOTE_ADDR&quot;: &quot;<a href="http://wtest.example.com/" target="_blank" rel="noreferrer">http://wtest.example.com/</a>&quot; }</p><p>\u542F\u52A8\u6307\u5B9A\u7684\u73AF\u5883\uFF1Apm2 start app.js --env development \u8D1F\u8F7D\u5747\u8861 pm2 start app.js -i 3 # \u5F00\u542F\u4E09\u4E2A\u8FDB\u7A0B pm2 start app.js -i max # \u6839\u636E\u673A\u5668CPU\u6838\u6570\uFF0C\u5F00\u542F\u5BF9\u5E94\u6570\u76EE\u7684\u8FDB\u7A0B</p><p>\u5F00\u673A\u81EA\u52A8\u542F\u52A8</p><p>\u901A\u8FC7pm2 save\u4FDD\u5B58\u5F53\u524D\u8FDB\u7A0B\u72B6\u6001\u3002 \u901A\u8FC7pm2 startup [platform]\u751F\u6210\u5F00\u673A\u81EA\u542F\u52A8\u7684\u547D\u4EE4\u3002\u4F8B\u5982\uFF1Apm2 startup centeros \u5C06\u6B65\u9AA42\u751F\u6210\u7684\u547D\u4EE4\uFF0C\u7C98\u8D34\u5230\u63A7\u5236\u53F0\u8FDB\u884C\uFF0C\u641E\u5B9A\u3002</p><p>\u66F4\u65B0 \u5B89\u88C5\u6700\u65B0\u7684\uFF1Anpm install pm2@latest -g<br> \u7136\u540E\u5728\u5185\u5B58\u4E2D\u66F4\u65B0\uFF1Apm2 update \u53C2\u8003</p><p>\u5B98\u65B9\u6587\u68631\uFF1A<a href="http://pm2.keymetrics.io/docs/usage/pm2-doc-single-page/" target="_blank" rel="noreferrer">http://pm2.keymetrics.io/docs/usage/pm2-doc-single-page/</a></p><p>\u5B98\u65B9\u6587\u68632\uFF1A<a href="http://pm2.keymetrics.io/docs/usage/quick-start/" target="_blank" rel="noreferrer">http://pm2.keymetrics.io/docs/usage/quick-start/</a></p><p>PM2\u5B9E\u7528\u5165\u95E8\u6307\u5357\uFF1A<a href="http://www.cnblogs.com/chyingp/p/pm2-documentation.html" target="_blank" rel="noreferrer">http://www.cnblogs.com/chyingp/p/pm2-documentation.html</a></p><p>nodejs\u9AD8\u5927\u4E0A\u7684\u90E8\u7F72\u65B9\u5F0F-PM2: <a href="http://www.2cto.com/kf/201501/367718.ht" target="_blank" rel="noreferrer">http://www.2cto.com/kf/201501/367718.ht</a></p><p>\u94FE\u63A5\uFF1A<a href="https://www.jianshu.com/p/f640450bd120" target="_blank" rel="noreferrer">https://www.jianshu.com/p/f640450bd120</a></p>`,25),e=[l];function t(r,c,F,D,u,y){return n(),a("div",null,e)}var d=s(p,[["render",t]]);export{q as __pageData,d as default};
