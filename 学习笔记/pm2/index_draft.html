<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>简介 | RainboyBlog</title>
    <meta name="description" content="RainboyBlog">
    <link rel="stylesheet" href="/assets/style.a8bcb8ad.css">
    <link rel="modulepreload" href="/assets/chunks/framework.6fa7194a.js">
    <link rel="modulepreload" href="/assets/学习笔记_pm2_index_draft.md.9626066f.lean.js">
    <link rel="modulepreload" href="/assets/app.c45f09fc.js">
    
    <link rel="shortcut icon" href="/favicon.ico">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-4efd05ef><!--[--><!--]--><!--[--><span tabindex="-1" data-v-1ce3ee4c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-1ce3ee4c> Skip to content </a><!--]--><!----><header class="VPNav no-sidebar" data-v-4efd05ef data-v-ee0e9772><div class="VPNavBar" data-v-ee0e9772 data-v-1b0bb9ca><div class="container" data-v-1b0bb9ca><div class="VPNavBarTitle" data-v-1b0bb9ca data-v-1e1557a5><a class="title" href="/" data-v-1e1557a5><!--[--><!--]--><!--[--><img class="VPImage logo" src="/favicon.ico" data-v-e179ba84><!--]--> RainboyBlog <!--[--><!--]--></a></div><div class="content" data-v-1b0bb9ca><!--[--><!--]--><!----><!----><!----><div class="VPNavBarAppearance appearance" data-v-1b0bb9ca data-v-21aad386><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-21aad386 data-v-1a8e2da5 data-v-179030d2><span class="check" data-v-179030d2><span class="icon" data-v-179030d2><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-1a8e2da5><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-1a8e2da5><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-1b0bb9ca data-v-127dfbad data-v-16635526><!--[--><a class="VPSocialLink" href="https://github.com/Rainboylvx/blogData" target="_blank" rel="noopener" data-v-16635526 data-v-01b08d1c><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-1b0bb9ca data-v-4b4f9bca data-v-5b5b5578><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-5b5b5578><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-5b5b5578><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-5b5b5578><div class="VPMenu" data-v-5b5b5578 data-v-184ff67e><!----><!--[--><!--[--><!----><div class="group" data-v-4b4f9bca><div class="item appearance" data-v-4b4f9bca><p class="label" data-v-4b4f9bca>Appearance</p><div class="appearance-action" data-v-4b4f9bca><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-4b4f9bca data-v-1a8e2da5 data-v-179030d2><span class="check" data-v-179030d2><span class="icon" data-v-179030d2><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-1a8e2da5><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-1a8e2da5><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-4b4f9bca><div class="item social-links" data-v-4b4f9bca><div class="VPSocialLinks social-links-list" data-v-4b4f9bca data-v-16635526><!--[--><a class="VPSocialLink" href="https://github.com/Rainboylvx/blogData" target="_blank" rel="noopener" data-v-16635526 data-v-01b08d1c><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-1b0bb9ca data-v-50e2b383><span class="container" data-v-50e2b383><span class="top" data-v-50e2b383></span><span class="middle" data-v-50e2b383></span><span class="bottom" data-v-50e2b383></span></span></button></div></div></div><!----></header><!----><!----><div class="VPContent" id="VPContent" data-v-4efd05ef data-v-4fa0bc67><div class="VPDoc" data-v-4fa0bc67 data-v-6851a958><div class="container" data-v-6851a958><!----><div class="content" data-v-6851a958><div class="content-container" data-v-6851a958><!--[--><!--]--><main class="main" data-v-6851a958><div style="position:relative;" class="vp-doc _%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0_pm2_index_draft" data-v-6851a958><div><h2 id="简介" tabindex="-1">简介 <a class="header-anchor" href="#简介" aria-hidden="true">#</a></h2><blockquote><p><code>pm2是node进程管理工具，可以利用它来简化很多node应用管理的繁琐任务，如性能监控、自动重启、负载均衡等，而且使用非常简单。</code></p></blockquote><h2 id="全局安装" tabindex="-1">全局安装 <a class="header-anchor" href="#全局安装" aria-hidden="true">#</a></h2><p>sudo npm install <code>pm2@latest -g</code></p><h2 id="用法" tabindex="-1">用法 <a class="header-anchor" href="#用法" aria-hidden="true">#</a></h2><ul><li>最简单的启用一个应用: <code>pm2 start app.js</code></li><li>停止：<code>pm2 stop app_name|app_id</code></li><li>删除：<code>pm2 delete app_name|app_id</code></li><li>重启：<code>pm2 restart app_name|app_id</code></li><li>停止所有：<code>pm2 stop all</code></li><li>查看所有的进程：<code>pm2 list</code></li><li>查看所有的进程状态：<code>pm2 status</code></li><li>查看某一个进程的信息：<code>pm2 describe app_name|app_id</code></li><li>监听:<code>pm2 monit</code></li></ul><h2 id="参数说明" tabindex="-1">参数说明 <a class="header-anchor" href="#参数说明" aria-hidden="true">#</a></h2><ul><li>--watch：监听应用目录源码的变化，一旦发生变化，自动重启。如果要精确监听、不见听的目录，最好通过配置文件</li><li>-i --instances：启用多少个实例，可用于负载均衡。如果-i 0或者-i max，则根据当前机器核数确定实例数目，可以弥补node.js缺陷</li><li>--ignore-watch：排除监听的目录/文件，可以是特定的文件名，也可以是正则。比如--ignore-watch=&quot;test node_modules &quot;some scripts&quot;</li><li>-n --name：应用的名称。查看应用信息的时候可以用到</li><li>-o --output <code>&lt;path&gt;</code>：标准输出日志文件的路径，有默认路径</li><li>-e --error <code>&lt;path&gt;</code>：错误输出日志文件的路径，有默认路径</li><li>--interpreter <code>&lt;interpreter&gt;</code>：the interpreter pm2 should use for executing app (bash, python...)。比如你用的coffee script来编写应用</li></ul><h2 id="配置文件" tabindex="-1">配置文件 <a class="header-anchor" href="#配置文件" aria-hidden="true">#</a></h2><p>配置文件里的设置项，跟命令行参数基本是一一对应的 配置文件的格式可以为json/yaml json格式的配置文件，pm2当作普通的js文件来处理，所以可以在里面添加注释或者编写代码，这对于动态调整配置很有好处 如果启动的时候指定了配置文件，那么命令行参数会被忽略（个别参数除外，比如--env）</p><h3 id="完整参数单个app配置：" tabindex="-1">完整参数单个app配置： <a class="header-anchor" href="#完整参数单个app配置：" aria-hidden="true">#</a></h3><div class="language-javascript line-numbers-mode"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">             : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">node-app</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">//启动app名称</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cwd</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">              : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/srv/node-app/current</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">args</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">             : [</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">--toto=heya coco</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-d</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">script</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">           : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">bin/app.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">node_args</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">        : [</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">--harmony</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> --max-stack-size=102400000</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">log_date_format</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">  : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">YYYY-MM-DD HH:mm Z</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">error_file</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">       : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/var/log/node-app/node-app.stderr.log</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">out_file</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">         : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">log/node-app.stdout.log</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pid_file</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">         : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pids/node-geo-api.pid</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">instances</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">        : </span><span style="color:#F78C6C;">6</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">//or 0 =&gt; &#39;max&#39;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">min_uptime</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">       : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">200s</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// 200 seconds, defaults to 1000</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">max_restarts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">     : </span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// defaults to 15</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">max_memory_restart</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1M</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// 1 megabytes, e.g.: &quot;2G&quot;, &quot;10M&quot;, &quot;100K&quot;, 1024 the default unit is byte.</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cron_restart</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">     : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1 0 * * *</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">watch</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">            : </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ignore_watch</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">      : [</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">[</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">/</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">]</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">./</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">node_modules</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">merge_logs</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">       : </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">exec_interpreter</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;"> : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">node</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">exec_mode</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">        : </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fork</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">autorestart</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">      : </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// enable/disable automatic restart when an app crashes or exits</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">vizion</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">           : </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// enable/disable vizion features (versioning control)</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// Default environment variables that will be injected in any environment and at any start</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">env</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">NODE_ENV</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">production</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">AWESOME_SERVICE_API_TOKEN</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">xxx</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">env_*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;"> : </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">SPECIFIC_ENV</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>完整配置文件写法： { &quot;apps&quot; : [{ // Application #1 &quot;name&quot; : &quot;worker-app&quot;, &quot;script&quot; : &quot;worker.js&quot;, &quot;args&quot; : [&quot;--toto=heya coco&quot;, &quot;-d&quot;, &quot;1&quot;], &quot;watch&quot; : true, &quot;node_args&quot; : &quot;--harmony&quot;, &quot;merge_logs&quot; : true, &quot;cwd&quot; : &quot;/this/is/a/path/to/start/script&quot;, &quot;env&quot;: { &quot;NODE_ENV&quot;: &quot;development&quot;, &quot;AWESOME_SERVICE_API_TOKEN&quot;: &quot;xxx&quot; }, &quot;env_production&quot; : { &quot;NODE_ENV&quot;: &quot;production&quot; }, &quot;env_staging&quot; : { &quot;NODE_ENV&quot; : &quot;staging&quot;, &quot;TEST&quot; : true } },{ // Application #2 &quot;name&quot; : &quot;api-app&quot;, &quot;script&quot; : &quot;api.js&quot;, &quot;instances&quot; : 4, &quot;exec_mode&quot; : &quot;cluster_mode&quot;, &quot;error_file&quot; : &quot;./examples/child-err.log&quot;, &quot;out_file&quot; : &quot;./examples/child-out.log&quot;, &quot;pid_file&quot; : &quot;./examples/child.pid&quot; }] }</p><p>通过yaml管理多个应用 process.yml:</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">apps:</span></span>
<span class="line"><span style="color:#A6ACCD;">  - script   : app.js</span></span>
<span class="line"><span style="color:#A6ACCD;">    instances: 4</span></span>
<span class="line"><span style="color:#A6ACCD;">    exec_mode: cluster</span></span>
<span class="line"><span style="color:#A6ACCD;">  - script : worker.js</span></span>
<span class="line"><span style="color:#A6ACCD;">    watch  : true</span></span>
<span class="line"><span style="color:#A6ACCD;">    env    :</span></span>
<span class="line"><span style="color:#A6ACCD;">      NODE_ENV: development</span></span>
<span class="line"><span style="color:#A6ACCD;">    env_production:</span></span>
<span class="line"><span style="color:#A6ACCD;">      NODE_ENV: production</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>启动：pm2 start process.yml 环境切换 正式开发中分为不同的环境(开发环境、测试环境、生产环境)，我们需要根据不同的情景来切换各种环境 pm2通过在配置文件中通过env_xx来声明不同环境的配置，然后在启动应用时，通过--env参数指定运行的环境 环境配置定义，在应用中，可以通过p<wbr>rocess.env.REMOTE_ADDR等来读取配置中生命的变量： &quot;env&quot;: { &quot;NODE_ENV&quot;: &quot;production&quot;, &quot;REMOTE_ADDR&quot;: &quot;<a href="http://www.example.com/" target="_blank" rel="noreferrer">http://www.example.com/</a>&quot; }, &quot;env_dev&quot;: { &quot;NODE_ENV&quot;: &quot;development&quot;, &quot;REMOTE_ADDR&quot;: &quot;<a href="http://wdev.example.com/" target="_blank" rel="noreferrer">http://wdev.example.com/</a>&quot; }, &quot;env_test&quot;: { &quot;NODE_ENV&quot;: &quot;test&quot;, &quot;REMOTE_ADDR&quot;: &quot;<a href="http://wtest.example.com/" target="_blank" rel="noreferrer">http://wtest.example.com/</a>&quot; }</p><p>启动指定的环境：pm2 start app.js --env development 负载均衡 pm2 start app.js -i 3 # 开启三个进程 pm2 start app.js -i max # 根据机器CPU核数，开启对应数目的进程</p><p>开机自动启动</p><p>通过pm2 save保存当前进程状态。 通过pm2 startup [platform]生成开机自启动的命令。例如：pm2 startup centeros 将步骤2生成的命令，粘贴到控制台进行，搞定。</p><p>更新 安装最新的：npm install pm2@latest -g<br> 然后在内存中更新：pm2 update 参考</p><p>官方文档1：<a href="http://pm2.keymetrics.io/docs/usage/pm2-doc-single-page/" target="_blank" rel="noreferrer">http://pm2.keymetrics.io/docs/usage/pm2-doc-single-page/</a></p><p>官方文档2：<a href="http://pm2.keymetrics.io/docs/usage/quick-start/" target="_blank" rel="noreferrer">http://pm2.keymetrics.io/docs/usage/quick-start/</a></p><p>PM2实用入门指南：<a href="http://www.cnblogs.com/chyingp/p/pm2-documentation.html" target="_blank" rel="noreferrer">http://www.cnblogs.com/chyingp/p/pm2-documentation.html</a></p><p>nodejs高大上的部署方式-PM2: <a href="http://www.2cto.com/kf/201501/367718.ht" target="_blank" rel="noreferrer">http://www.2cto.com/kf/201501/367718.ht</a></p><p>链接：<a href="https://www.jianshu.com/p/f640450bd120" target="_blank" rel="noreferrer">https://www.jianshu.com/p/f640450bd120</a></p></div></div></main><footer class="VPDocFooter" data-v-6851a958 data-v-2e2a3a74><div class="edit-info" data-v-2e2a3a74><div class="edit-link" data-v-2e2a3a74><a class="VPLink link edit-link-button" href="https://github.com/Rainboylvx/blogData/edit/master/学习笔记/pm2/index_draft.md" target="_blank" rel="noreferrer" data-v-2e2a3a74 data-v-1eed4281><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" data-v-2e2a3a74><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> Edit this page on GitHub<!--]--><!----></a></div><!----></div><!----></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"englishlearn_index.md\":\"1e88e5ec\",\"linux命令与软件_imagemagick使用.md\":\"d3214404\",\"linux命令与软件__nginx.md\":\"94e2406e\",\"linux命令与软件_awk.md\":\"82d0198f\",\"linux命令与软件_bspwm.md\":\"5dfda9a2\",\"linux命令与软件_buku.md\":\"de0fa794\",\"linux命令与软件_cups_打印机hp202dw.md\":\"59da2d87\",\"linux命令与软件_ffmpeg.md\":\"40344db3\",\"linux命令与软件_index.md\":\"06defc90\",\"linux命令与软件_irc.md\":\"1f75f7b8\",\"linux命令与软件_navi.md\":\"83b6c482\",\"linux命令与软件_nfs.md\":\"c4fed153\",\"linux命令与软件_sed.md\":\"27f6ed40\",\"linux命令与软件_ssh.md\":\"0584faf2\",\"linux命令与软件_tinytinyrss.md\":\"a340045b\",\"linux命令与软件_tmux.md\":\"b167c856\",\"vim_index.md\":\"52262b0b\",\"vim_learn_vimscript_the_hard_way.md\":\"d3952b0e\",\"vim_vim-complete.md\":\"3f3e3ed0\",\"vim_vim-config-options.md\":\"e80db748\",\"vim_vim-fold.md\":\"a708edaf\",\"vim_vim-regex.md\":\"d40edb2f\",\"vim_vim插件_vimemoji.md\":\"48f97929\",\"vim_vim插件emmet_draft.md\":\"a88fe9fa\",\"vim_在vim中生成tag.md\":\"b9d75534\",\"vim_如何编写vim插件.md\":\"2aa1de55\",\"_单片机_f1c100s_1-初食.md\":\"9a834672\",\"_单片机_f1c100s_2-点亮led仪式.md\":\"3d9e4373\",\"_单片机_rt-thread_rt-thread学习路线.md\":\"d577e83c\",\"_单片机_rt-thread_内核笔记.md\":\"eb1c4889\",\"_单片机_usb_usb协议.md\":\"630dcdda\",\"_单片机_xmega_1.熟悉.md\":\"9c0dd797\",\"_单片机_xmega_adc.md\":\"83dd79f7\",\"_单片机_xmega_eeprom的原理.md\":\"dc8ab251\",\"_单片机_xmega_twi总线.md\":\"d74e3031\",\"_单片机_xmega_keyplus分析笔记.md\":\"3676281f\",\"_单片机_xmega_中断.md\":\"a5a91896\",\"_单片机_xmega_头文件.md\":\"0f61428d\",\"_单片机_xmega_片内定时器.md\":\"c47a6fa3\",\"_单片机_xmega_看门狗.md\":\"c2b90eec\",\"_单片机_xmega_端口ioport.md\":\"2253810f\",\"_单片机_xmega_第6章avr_cpu.md\":\"3d13ec5c\",\"_单片机_xmega_第7章memory.md\":\"ebcb39a4\",\"_单片机_芯片_74hc595的理解.md\":\"4a9f5fde\",\"_单片机_芯片_pca9555.md\":\"b494fbf4\",\"_日常技巧_windows.md\":\"c947ddda\",\"_日常生活_养小孩_辅食.md\":\"2621f9fd\",\"_研究思考__markdown思考视频的脚本.md\":\"0e31f8e4\",\"_研究思考_dsa的重构_1_draft.md\":\"5085864b\",\"_研究思考_nodejs_require的使用的思考.md\":\"5819799d\",\"index.md\":\"e1d65df5\",\"program_under_linux_index.md\":\"fb65c483\",\"program_under_linux_io.md\":\"222722ca\",\"program_under_linux_pipe_index.md\":\"fab435bd\",\"program_under_linux_socket_index.md\":\"35ab1c4a\",\"readme.md\":\"af37ce34\",\"力引导算法_draft.md\":\"7b01ea1d\",\"学习笔记_argp_argp_parse的使用.md\":\"75b60d6f\",\"学习笔记_celery_celery1_draft.md\":\"f635681f\",\"学习笔记_cmake学习笔记一.md\":\"228ca967\",\"学习笔记_cmake学习笔记二.md\":\"8ef4834a\",\"学习笔记_d3js_index.md\":\"24a7a0cb\",\"学习笔记_graphviz_cheatsheet.md\":\"983a9967\",\"学习笔记_graphviz_使用dot语言.md\":\"0b1cc96f\",\"学习笔记_graphviz_入门.md\":\"41a4d927\",\"学习笔记_haskell_episode1.md\":\"4536c3f2\",\"学习笔记_haskell_episode2.md\":\"bada33a9\",\"学习笔记_haskell_episode3.md\":\"5a83a29b\",\"学习笔记_haskell_episode4.md\":\"1a6b426a\",\"学习笔记_haskell_episode5.md\":\"53c47527\",\"学习笔记_haskell_episode6.md\":\"0ea24d17\",\"学习笔记_haskell_episode7.md\":\"f4e494b5\",\"学习笔记_haskell_episode8.md\":\"8d0f6832\",\"学习笔记_haskell_index.md\":\"08986780\",\"学习笔记_html_实现滑动菜单.md\":\"c006ff41\",\"学习笔记_html_自适应.md\":\"33500518\",\"学习笔记_index.md\":\"e1c076ba\",\"学习笔记_koa2_compose.md\":\"5a0b9e6d\",\"学习笔记_koa2_index.md\":\"57b654eb\",\"学习笔记_koa2_route.md\":\"7e1b58e6\",\"学习笔记_lua_index.md\":\"e6b47964\",\"学习笔记_markdown-it_markdown-it解析.md\":\"13cd2be8\",\"学习笔记_mongodb_aggregation.md\":\"da6869b0\",\"学习笔记_mongodb_populate_virtual_draft.md\":\"14b4162c\",\"学习笔记_p5.js_draft_index.md\":\"68c49b70\",\"学习笔记_pm2_index_draft.md\":\"9626066f\",\"学习笔记_python_1.开始.md\":\"23dbff1b\",\"学习笔记_python_小甲鱼python笔记.md\":\"41fca4fc\",\"学习笔记_python_常用函数.md\":\"99363641\",\"学习笔记_python_标准库_argparse.md\":\"9e7cce0f\",\"学习笔记_redis学习笔记_入门_draft.md\":\"39d36016\",\"学习笔记_redis学习笔记_初识redis_draft.md\":\"753f50bc\",\"学习笔记_sass_draft_index.md\":\"30acf037\",\"学习笔记_webpack_css单独打包.md\":\"722ca560\",\"学习笔记_webpack_index.md\":\"89511467\",\"学习笔记_winston_winston学习笔记.md\":\"c18be27e\",\"学习笔记_其他_usb_hid描述符学习.md\":\"62182698\",\"源码解读_markdown-it_block-table.md\":\"08b50454\",\"源码解读_markdown-it_markdown-it解读.md\":\"b34f5e16\",\"源码解读_markdown-it_ruler-3.md\":\"f88ad338\",\"源码解读_markdown-it_token-2.md\":\"d96e7e27\",\"源码解读_tinyasync_2022-11-8.md\":\"dc9efcb8\",\"源码解读_tinyasync_code_by_self_readme.md\":\"e7afc2fb\",\"源码解读_tinyasync_continue.md\":\"58e75365\",\"源码解读_tinyasync_event.md\":\"02bd0369\",\"源码解读_tinyasync_example_echo_server.md\":\"2fa96757\",\"源码解读_tinyasync_first.md\":\"da9c9a51\",\"源码解读_tinyasync_index.md\":\"807d3ee6\",\"源码解读_tinyasync_last.md\":\"a2a97977\",\"源码解读_tinyasync_pingpong.md\":\"54676c01\",\"源码解读_tinyasync_源码_io_context.md\":\"2c235c3b\",\"源码解读_vitepress_vitepress.md\":\"907bbd3d\",\"网页前端_animate.css_index.md\":\"2649c2ff\",\"网页前端_bootstrap_index.md\":\"d340f32b\",\"网页前端_grid布局.md\":\"b5d5cf0b\",\"网页前端_表单验证_index.md\":\"7791d45f\"}")</script>
    <script type="module" async src="/assets/app.c45f09fc.js"></script>
    
  </body>
</html>